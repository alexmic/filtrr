<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Filtrr2 Tests</title>
    <link rel="stylesheet" href="../lib/qunit.css" type="text/css" media="screen" />
    <script type="text/javascript" src="../lib/jquery.min.js"/></script>
    <script type="text/javascript" src="../lib/qunit.js"></script>
    <script type="text/javascript" src="../src/filtrr2.js"></script>
    <script type="text/javascript" src="../src/util.js"></script>
    <script type="text/javascript" src="../src/events.js"></script>
    <script type="text/javascript" src="../src/effects.js"></script>    
    <script type="text/javascript">
        $(document).ready(function(){

            module("Initialization tests");

            asyncTest("Initialize from image id.", function() {
                Filtrr("#test-img", function() {
                   ok(true);
                   start(); 
                });
            });

            asyncTest("Initialize from image css class.", function() {
                Filtrr(".test-img1", function() {
                   ok(true);
                   start(); 
                });
            });

            asyncTest("Initialize from jq image.", function() {
                Filtrr($("#test-img2"), function() {
                   ok(true);
                   start(); 
                });
            });

            asyncTest("Initialize from canvas id.", function() {
                Filtrr("#test-canvas", function() {
                   ok(true);
                   start(); 
                });
            });

            asyncTest("Initialize from canvas css class.", function() {
                Filtrr(".test-canvas1", function() {
                   ok(true);
                   start(); 
                });
            });

            asyncTest("Initialize from jq canvas.", function() {
                Filtrr($("#test-canvas2"), function() {
                   ok(true);
                   start(); 
                });
            });

            asyncTest("Non existing DOM object.", function() {
                raises(function() {
                    Filtrr(undefined, function() {});
                });
                start();
            });
            
            asyncTest("Non existing DOM object.", function() {
                raises(function() {
                    Filtrr(null, function() {});
                });
                start();
            });


            asyncTest("Non existing DOM object.", function() {
                raises(function() {
                    Filtrr($("#asfafa"), function() {});
                });
                start();
            });

            module("Re-initialization tests (is the store working?)");

            test("Re-initialize from image id.", function() {
                ok(Filtrr("#test-img").ready());
            });

            test("Re-initialize from image css class.", function() {
                ok(Filtrr(".test-img1").ready());
            });

            test("Re-initialize from jq image.", function() {
                ok(Filtrr($("#test-img2")).ready());
            });

            test("Re-initialize from canvas id.", function() {
                ok(Filtrr("#test-canvas").ready());
            });

            test("Re-initialize from canvas css class.", function() {
                ok(Filtrr(".test-canvas1").ready());
            });

            test("Re-initialize from jq canvas.", function() {
                ok(Filtrr($("#test-canvas2")).ready());
            });

            module("Correctness tests");

            function check(f) {
                var c = f.canvas, e = f.el;
                ok(f.on);
                ok(f.off);
                ok(f.trigger);
                ok(f.el);
                ok(f.canvas);
                ok(f.processor);
                equal(c.height(), e.height());
                equal(c.width(), e.width());
                if (e[0].nodeName.toLowerCase() === "img") {
                    equal(c.css("position"), "absolute");
                }
            }

            asyncTest("Image id.", function() {
                var f = Filtrr("#test-img11");
                f.ready(function (){
                    check(f);
                    start();
                });
            });

            asyncTest("Image css class.", function() {
                var f = Filtrr(".test-img11");
                f.ready(function (){
                    check(f);
                    start();
                });
            });

            asyncTest("jQuery image.", function() {
                var f = Filtrr($("#test-img21"));
                f.ready(function (){
                    check(f);
                    start();
                });
            });

            asyncTest("Re-initialize from canvas id.", function() {
                var f = Filtrr("#test-canvas111");
                f.ready(function (){
                    check(f);
                    start();
                });
            });

            asyncTest("Re-initialize from canvas css class.", function() {
                var f = Filtrr(".test-canvas1111");
                f.ready(function (){
                    check(f);
                    start();
                });
            });

            asyncTest("Re-initialize from canvas css class.", function() {
                var f = Filtrr(".test-canvas1111");
                f.ready(function (){
                    check(f);
                    start();
                });
            });

            asyncTest("Re-initialize from jq canvas.", function() {
                var f = Filtrr($("#test-canvas2111"));
                f.ready(function (){
                    check(f);
                    start();
                });
            });
            
        });
    </script>
</head>
<body>
    <h1 id="qunit-header">Filtrr2 Test Suite</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">test markup, will be hidden</div>
    <img style="visibility:hidden" id="test-img" src="../pic.jpg" />
    <img style="visibility:hidden" class="test-img1" src="../pic.jpg" />
    <img style="visibility:hidden" id="test-img2" src="../pic.jpg" />
    <canvas style="visibility:hidden" id="test-canvas"></canvas>
    <canvas style="visibility:hidden" class="test-canvas1"></canvas>
    <canvas style="visibility:hidden" id="test-canvas2"></canvas>
    <img style="visibility:hidden" id="test-img11" src="../pic.jpg" />
    <img style="visibility:hidden" class="test-img11" src="../pic.jpg" />
    <img style="visibility:hidden" id="test-img21" src="../pic.jpg" />
    <canvas style="visibility:hidden" id="test-canvas111"></canvas>
    <canvas style="visibility:hidden" class="test-canvas1111"></canvas>
    <canvas style="visibility:hidden" id="test-canvas2111"></canvas>
</body>
</html>